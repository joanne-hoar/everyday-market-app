<div class="register-container">
  <div class="register-card">
    <h1>Create Your Account</h1>
    <p class="register-subtitle">Join Everyday Market to start shopping with us</p>

    <form #registerForm="ngForm" (ngSubmit)="onSubmit()" novalidate>
      
      <!-- Name Field -->
      <div class="form-group">
        <label for="name">Full Name *</label>
        <input 
          type="text" 
          id="name" 
          name="name"
          [(ngModel)]="user.name"
          #name="ngModel"
          appNameValidator
          required
          class="form-control"
          [class.invalid]="name.invalid && name.touched"
          placeholder="Enter your full name (minimum 5 characters)"
        />
        @if (name.invalid && name.touched) {
          <div class="error-messages">
            @if (name.errors?.['required']) {
              <div>Name is required</div>
            }
            @if (name.errors?.['nameInvalid']) {
              <div>Name must contain only letters and spaces, minimum 5 characters</div>
            }
          </div>
        }
      </div>

      <!-- Email Field -->
      <div class="form-group">
        <label for="email">Email Address *</label>
        <input 
          type="email" 
          id="email" 
          name="email"
          [(ngModel)]="user.email"
          #email="ngModel"
          required
          email
          class="form-control"
          [class.invalid]="email.invalid && email.touched"
          placeholder="Enter your email address"
        />
        @if (email.invalid && email.touched) {
          <div class="error-messages">
            @if (email.errors?.['required']) {
              <div>Email is required</div>
            }
            @if (email.errors?.['email']) {
              <div>Please enter a valid email address</div>
            }
          </div>
        }
      </div>

      <!-- Phone Field -->
      <div class="form-group">
        <label for="phone">Phone Number *</label>
        <input 
          type="tel" 
          id="phone" 
          name="phone"
          [(ngModel)]="user.phone"
          #phone="ngModel"
          appPhoneValidator
          required
          class="form-control"
          [class.invalid]="phone.invalid && phone.touched"
          placeholder="10-digit phone number"
        />
        @if (phone.invalid && phone.touched) {
          <div class="error-messages">
            @if (phone.errors?.['required']) {
              <div>Phone number is required</div>
            }
            @if (phone.errors?.['phoneInvalid']) {
              <div>Phone number must be exactly 10 digits</div>
            }
          </div>
        }
      </div>

      <!-- Date of Birth Field -->
      <div class="form-group">
        <label for="dateOfBirth">Date of Birth *</label>
        <input 
          type="date" 
          id="dateOfBirth" 
          name="dateOfBirth"
          [(ngModel)]="user.dateOfBirth"
          #dateOfBirth="ngModel"
          required
          class="form-control"
          [class.invalid]="dateOfBirth.invalid && dateOfBirth.touched"
        />
        @if (dateOfBirth.invalid && dateOfBirth.touched) {
          <div class="error-messages">
            @if (dateOfBirth.errors?.['required']) {
              <div>Date of birth is required</div>
            }
          </div>
        }
      </div>

      <!-- Street Address Field -->
      <div class="form-group">
        <label for="streetAddress">Street Address *</label>
        <input 
          type="text" 
          id="streetAddress" 
          name="streetAddress"
          [(ngModel)]="user.streetAddress"
          #streetAddress="ngModel"
          required
          pattern="^[a-zA-Z0-9\s]+$"
          class="form-control"
          [class.invalid]="streetAddress.invalid && streetAddress.touched"
          placeholder="Enter your street address"
        />
        @if (streetAddress.invalid && streetAddress.touched) {
          <div class="error-messages">
            @if (streetAddress.errors?.['required']) {
              <div>Street address is required</div>
            }
            @if (streetAddress.errors?.['pattern']) {
              <div>Address can only contain letters, numbers, and spaces</div>
            }
          </div>
        }
      </div>

      <!-- Province Field -->
      <div class="form-group">
        <label for="province">Province/Territory *</label>
        <select 
          id="province" 
          name="province"
          [(ngModel)]="user.province"
          #province="ngModel"
          required
          class="form-control"
          [class.invalid]="province.invalid && province.touched"
        >
          <option value="">Select a province or territory</option>
          @for (prov of provinces; track prov) {
            <option [value]="prov">{{ prov }}</option>
          }
        </select>
        @if (province.invalid && province.touched) {
          <div class="error-messages">
            @if (province.errors?.['required']) {
              <div>Province/Territory is required</div>
            }
          </div>
        }
      </div>

      <!-- Country Field -->
      <div class="form-group">
        <label for="country">Country *</label>
        <select 
          id="country" 
          name="country"
          [(ngModel)]="user.country"
          #country="ngModel"
          required
          class="form-control"
          [class.invalid]="country.invalid && country.touched"
        >
          <option value="">Select a country</option>
          @for (ctry of countries; track ctry) {
            <option [value]="ctry">{{ ctry }}</option>
          }
        </select>
        @if (country.invalid && country.touched) {
          <div class="error-messages">
            @if (country.errors?.['required']) {
              <div>Country is required</div>
            }
          </div>
        }
        @if (country.valid && user.country !== 'Canada') {
          <div class="error-messages">
            <div class="country-warning">You must select Canada to proceed</div>
          </div>
        }
      </div>

      <!-- Terms and Conditions -->
      <div class="form-group checkbox-group">
        <label class="checkbox-label">
          <input 
            type="checkbox" 
            name="acceptTerms"
            [(ngModel)]="user.acceptTerms"
            #acceptTerms="ngModel"
            required
            class="checkbox-input"
          />
          <span class="checkmark"></span>
          I accept the <a href="#" class="terms-link">Terms & Conditions</a> *
        </label>
        @if (!user.acceptTerms && acceptTerms.touched) {
          <div class="error-messages">
            <div>You must accept the Terms & Conditions to continue</div>
          </div>
        }
      </div>

      <!-- Submit Button -->
      <div class="form-actions">
        <button 
          type="submit" 
          class="submit-btn"
          [disabled]="!isFormValid(registerForm)"
          [class.enabled]="isFormValid(registerForm)"
        >
          Create Account
        </button>
      </div>

    </form>
  </div>
</div>
